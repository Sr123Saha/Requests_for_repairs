{% extends "base.html" %}

{% block title %}–ó–∞—è–≤–∫–∏{% endblock %}
{% block header %}–°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫{% endblock %}

{% block content %}
<h1>–°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫</h1>
<p><a class="btn btn-success btn-sm" href="{{ url_for('new_request') }}">–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</a></p>
<div class="table-responsive">
  <table class="table table-striped table-bordered mb-0">
    <thead>
      <tr>
        <th>ID</th>
        <th>–ù–æ–º–µ—Ä</th>
        <th>–î–∞—Ç–∞</th>
        <th>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</th>
        <th>–ü—Ä–æ–±–ª–µ–º–∞</th>
        <th>–ö–ª–∏–µ–Ω—Ç</th>
        <th>–ú–∞—Å—Ç–µ—Ä</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody>
      {% for r in requests %}
      <tr>
        <td>{{ r.request_id }}</td>
        <td>{{ r.request_number }}</td>
        <td>{{ r.start_date }}</td>
        <td>{{ r.climate_tech_type }} / {{ r.climate_tech_model }}</td>
        <td>{{ r.problem_description }}</td>
        <td>{{ r.client_fio }}</td>
        <td>
          {% if r.master_fio %}
            {{ r.master_fio }}
            {% if r.master_phone %}
              <br><small class="text-muted">{{ r.master_phone }}</small>
            {% endif %}
          {% else %}
            <span class="text-muted">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</span>
          {% endif %}
        </td>
        <td><span class="badge status-badge {{ r.status_class }}">{{ r.request_status }}</span></td>
        <td>
          {% if r.can_edit %}
            <a href="{{ url_for('edit_request', request_id=r.request_id) }}" 
               class="btn btn-outline-warning btn-sm me-1" 
               title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞—è–≤–∫—É">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
          {% endif %}
          <a href="{{ url_for('qr_for_request', request_id=r.request_id) }}" target="_blank"
             class="btn btn-outline-primary btn-sm" title="QR-–∫–æ–¥ –¥–ª—è –æ—Ç–∑—ã–≤–∞">
            üì± QR
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

